
function bradford(c::XYZ, src::XYZ, dest::XYZ)
    BFD = [ 0.8951  0.2664 -0.1614
           -0.7502  1.7135  0.0367
            0.0389 -0.0685  1.0296 ]
    BFD_INV = inv(BFD)

    c_lms = BFD * [c.x, c.y, c.z]
    src_wp = BFD * [src.x, src.y, src.z]
    dest_wp = BFD * [dest.x, dest.y, dest.z]
    c_out = BFD_INV * (c_lms .* dest_wp ./ src_wp)
    (typeof(c))(c_out...)
end

function srgb_to_pcslab(c::RGB)
    xyz65 = convert(XYZ, c)
    xyz50 = bradford(xyz65, Colors.WP_D65, Colors.WP_D50)
    convert(Lab, xyz50, Colors.WP_D50)
end

function pcslab_to_srgb(c::Lab)
    xyz50 = convert(XYZ, c, Colors.WP_D50)
    xyz65 = bradford(xyz50, Colors.WP_D50, Colors.WP_D65)
    convert(RGB, xyz65)
end

# values from DIC Digial Color Guide
# https://www.dic-graphics.co.jp/en/products/dcguide/
const DIC_COLORS = Pair{UInt32, CMYK{Float64}}[
    0xfda8a7 => CMYK(0.00, 0.42, 0.26), # DIC-4
    0xf5dd7a => CMYK(0.00, 0.07, 0.59), # DIC-9
    0x91d48c => CMYK(0.42, 0.00, 0.52), # DIC-14
    0x7ad8d4 => CMYK(0.46, 0.00, 0.22), # DIC-17
    0x94b7dc => CMYK(0.41, 0.15, 0.00), # DIC-44
    0xeeb4ce => CMYK(0.00, 0.36, 0.02), # DIC-24
    0xfe6377 => CMYK(0.00, 0.68, 0.38), # DIC-51
    0xfad238 => CMYK(0.00, 0.13, 0.82), # DIC-57
    0x69d485 => CMYK(0.50, 0.00, 0.56), # DIC-62
    0x00c1cd => CMYK(0.64, 0.00, 0.22), # DIC-66
    0x5b8ec3 => CMYK(0.62, 0.30, 0.04), # DIC-70
    0xdd71b5 => CMYK(0.04, 0.62, 0.00), # DIC-47
    0xf93c48 => CMYK(0.00, 0.76, 0.62), # DIC-116
    0xfdc900 => CMYK(0.00, 0.19, 0.96), # DIC-125
    0x00ba61 => CMYK(0.70, 0.00, 0.76), # DIC-131
    0x00a6b4 => CMYK(0.86, 0.00, 0.26), # DIC-136
    0x5666be => CMYK(0.70, 0.56, 0.00), # DIC-143
    0xc01f9d => CMYK(0.24, 0.88, 0.00), # DIC-151
    0x922a31 => CMYK(0.38, 1.00, 0.98, 0.14), # DIC-305
    0x7c6632 => CMYK(0.49, 0.52, 0.96, 0.20), # DIC-354
    0x2f6339 => CMYK(0.83, 0.41, 0.98, 0.24), # DIC-377
    0x006066 => CMYK(0.97, 0.46, 0.53, 0.21), # DIC-408
    0x204068 => CMYK(0.98, 0.83, 0.41, 0.12), # DIC-433
    0x6a3256 => CMYK(0.61, 0.92, 0.43, 0.20), # DIC-497
    0x7d7a7d => CMYK(0.54, 0.48, 0.44, 0.00), # DIC-G25
    0x887b75 => CMYK(0.50, 0.48, 0.49, 0.00), # DIC-G35
    0x7c7f72 => CMYK(0.55, 0.44, 0.53, 0.00), # DIC-G45
    0x74827f => CMYK(0.58, 0.42, 0.46, 0.00), # DIC-G55
    0x7b7f84 => CMYK(0.55, 0.45, 0.41, 0.00), # DIC-G65
    0x8c8184 => CMYK(0.48, 0.46, 0.40, 0.00), # DIC-G75
]


# values from the Fogra MediaWedge CMYK V3.0 subsets
# https://fogra.org/en/downloads/work-tools/characterisation-data
const FOGRA53_COLORS = Pair{CMYK{Float64}, Lab{Float64}}[
    CMYK(1.0, 0, 0) => Lab(51.00, -39.75, -55.44),
    CMYK(0.7, 0, 0) => Lab(69.80, -28.04, -39.01),
    CMYK(0.4, 0, 0) => Lab(82.25, -15.41, -24.20),
    CMYK(0.2, 0, 0) => Lab(89.35,  -7.37, -14.29),
    CMYK(0.1, 0, 0) => Lab(92.97,  -3.20,  -8.77),
    CMYK(0, 1.0, 0) => Lab(52.00, 80.29,  -7.37),
    CMYK(0, 0.7, 0) => Lab(63.50, 61.72, -12.35),
    CMYK(0, 0.4, 0) => Lab(77.63, 37.95, -11.82),
    CMYK(0, 0.2, 0) => Lab(86.76, 21.50,  -9.48),
    CMYK(0, 0.1, 0) => Lab(91.64, 11.44,  -6.70),
    CMYK(0, 0, 1.0) => Lab(92.50, -4.88, 103.33),
    CMYK(0, 0, 0.7) => Lab(93.78, -4.22,  68.56),
    CMYK(0, 0, 0.4) => Lab(95.01, -2.80,  35.46),
    CMYK(0, 0, 0.2) => Lab(95.87, -1.17,  16.56),
    CMYK(0, 0, 0.1) => Lab(96.24, -0.13,   6.84),
    CMYK(0, 0, 0, 0.1) => Lab(90.10, 0.90, -2.75),
    CMYK(0, 0, 0, 0.2) => Lab(83.69, 0.81, -2.50),
    CMYK(0, 0, 0, 0.4) => Lab(70.73, 0.62, -2.02),
    CMYK(0, 0, 0, 0.6) => Lab(56.11, 0.44, -1.49),
    CMYK(0, 0, 0, 0.8) => Lab(37.17, 0.23, -0.80),
    CMYK(0, 0, 0, 1.0) => Lab(14.00, 0.00,  0.00),
    CMYK(0, 1.0, 0.0, 1.0) => Lab(10.42, 13.93,  1.35),
    CMYK(0, 0.7, 0.7, 0.6) => Lab(35.25, 34.23, 23.70),
    CMYK(0, 0.0, 0.7, 0.8) => Lab(36.20, -3.28, 26.29),
    CMYK(1.0, 1.0, 0) => Lab(23.00, 29.64, -58.13),
    CMYK(0.7, 0.7, 0) => Lab(40.72, 28.87, -44.47),
    CMYK(0.4, 0.4, 0) => Lab(62.64, 20.37, -30.76),
    CMYK(0.2, 0.2, 0) => Lab(78.70, 12.85, -19.65),
    CMYK(0.1, 0.1, 0) => Lab(87.66,  7.24, -12.16),
    CMYK(0, 1.0, 1.0) => Lab(47.00, 73.42, 52.23),
    CMYK(0, 0.7, 0.7) => Lab(60.85, 59.39, 40.41),
    CMYK(0, 0.4, 0.4) => Lab(76.15, 36.95, 22.02),
    CMYK(0, 0.2, 0.2) => Lab(85.76, 20.43,  9.25),
    CMYK(0, 0.1, 0.1) => Lab(91.16, 10.70,  3.11),
    CMYK(1.0, 0, 1.0) => Lab(49.50, -78.03, 31.82),
    CMYK(0.7, 0, 0.7) => Lab(65.66, -46.97, 24.12),
    CMYK(0.4, 0, 0.4) => Lab(79.55, -24.42, 10.27),
    CMYK(0.2, 0, 0.2) => Lab(88.13, -11.35,  3.75),
    CMYK(0.1, 0, 0.1) => Lab(92.46,  -4.85,  0.53),
    CMYK(0.1, 0.06, 0.06) => Lab(89.17,  2.19, -5.26),
    CMYK(0.2, 0.12, 0.12) => Lab(81.25,  2.90, -7.17),
    CMYK(0.4, 0.27, 0.27) => Lab(63.44,  5.34, -7.97),
    CMYK(0.6, 0.45, 0.45) => Lab(46.24,  5.63, -6.52),
    CMYK(0.8, 0.65, 0.65) => Lab(29.91,  4.20, -4.71),
    CMYK(1.0, 0.85, 0.85) => Lab(15.35, -4.03, -5.96),
    CMYK(1.0, 0.0, 0.0, 1.0) => Lab(10.41,  -8.20, -10.25),
    CMYK(0.2, 1.0, 0.7, 0.6) => Lab(25.07,  36.93,  12.37),
    CMYK(0.7, 0.0, 0.7, 0.8) => Lab(25.78, -19.49,   9.02),
    CMYK(1.0, 1.0, 1.0) => Lab(10.00,  0.00,  0.00),
    CMYK(0.7, 0.7, 0.7) => Lab(31.13, 13.70,  2.44),
    CMYK(0.4, 0.4, 0.4) => Lab(56.40, 13.73, -0.35),
    CMYK(0.2, 0.2, 0.2) => Lab(76.06,  9.88, -2.38),
    CMYK(0.1, 0.1, 0.1) => Lab(86.78,  5.91, -2.86),
    CMYK(0.2, 0.7, 0.7, 0.0) => Lab(50.47, 45.71, 28.02),
    CMYK(0.4, 0.7, 0.7, 0.2) => Lab(37.62, 27.92, 15.81),
    CMYK(0.4, 1.0, 1.0, 0.2) => Lab(28.19,  39.68,  26.04),
    CMYK(0.4, 1.0, 0.4, 0.2) => Lab(32.21,  46.98,  -7.54),
    CMYK(0.4, 0.4, 1.0, 0.2) => Lab(46.36,   5.89,  46.42),
    CMYK(1.0, 0.4, 1.0, 0.2) => Lab(26.25, -35.05,  13.90),
    CMYK(1.0, 0.4, 0.4, 0.2) => Lab(30.34, -19.98, -23.99),
    CMYK(1.0, 1.0, 0.4, 0.2) => Lab(16.19,  14.23, -30.31),
    CMYK(0.1, 0.4, 0.4) => Lab(70.47, 30.8, 15.88),
    CMYK(0, 0.4, 1) => Lab(72.08,  36.48,  80.76),
    CMYK(0, 1, 0.4) => Lab(52.74,  79.27,  12.88),
    CMYK(0.4, 1, 0) => Lab(40.13,  61.00, -32.66),
    CMYK(0.4, 0, 1) => Lab(76.68, -30.78,  75.50),
    CMYK(1, 0, 0.4) => Lab(52.28, -59.42, -23.17),
    CMYK(1, 0.4, 0) => Lab(39.70, -11.46, -55.77),
    CMYK(0.0, 0.0, 0.0) => Lab(96.5, 1.00, -3.00),
    CMYK(0.0, 0.0, 1, 1.0) => Lab(13.71,  -3.08,  11.68),
    CMYK(0.0, 0.7, 0, 0.6) => Lab(36.96,  36.50,  -6.46),
    CMYK(0.7, 0.0, 0, 0.8) => Lab(27.40, -12.45, -14.88),
]

const FOGRA53_COLORS_SRGB = map(p -> pcslab_to_srgb(p[2]) => p[1], FOGRA53_COLORS)
